"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[5631],{8764:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"Deployment Instructions/SetUp","title":"Setting up the server","description":"This page will help you navigate to the right pages, settings, and installations to set up your server correctly. This page is verified by: Laerk Ndreko","source":"@site/docs/Deployment Instructions/SetUp.md","sourceDirName":"Deployment Instructions","slug":"/Deployment Instructions/SetUp","permalink":"/docs/Deployment Instructions/SetUp","draft":false,"unlisted":false,"editUrl":"https://github.com/Digital-Information-Research-Lab/digital-information-research-lab.github.io/edit/documentation/docs/Deployment Instructions/SetUp.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Deployment Docs","permalink":"/docs/category/deployment-docs"},"next":{"title":"Installation Guide","permalink":"/docs/installation 2"}}');var r=s(4848),t=s(8453);const l={},o="Setting up the server",c={},d=[{value:'<span class="h2style">\ud83d\udfe0 Initial Navigation</span>',id:"-initial-navigation",level:2},{value:"\ud83d\udfe0 Server Settings",id:"-server-settings",level:2},{value:"\ud83d\udfe0 Firewall Settings",id:"-firewall-settings",level:2},{value:"\ud83d\udfe0 SSH and Terminal Instructions",id:"-ssh-and-terminal-instructions",level:2},{value:"\ud83d\udfe0 SSH-Keygen &amp; Repo Instructions",id:"-ssh-keygen--repo-instructions",level:2}];function a(e){const n={blockquote:"blockquote",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",hr:"hr",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"setting-up-the-server",children:"Setting up the server"})}),"\n",(0,r.jsxs)(n.p,{children:["This page will help you navigate to the right pages, settings, and installations to set up your server correctly. This page is verified by: ",(0,r.jsx)(n.em,{children:"Laerk Ndreko"})]}),"\n",(0,r.jsx)(n.h2,{id:"-initial-navigation",children:(0,r.jsx)("span",{class:"h2style",children:"\ud83d\udfe0 Initial Navigation"})}),"\n",(0,r.jsxs)(n.p,{children:["To start, navigate to ",(0,r.jsx)(n.strong,{children:"console.cloud.com"})," using an appropriate BU or other authorized account."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["If you are given access to the project, you should be able to see ",(0,r.jsx)(n.strong,{children:'"empirica-fall-2024"'}),".","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"If this is not the case, please contact a team lead or supervisor of the research to access."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["On the top-left-hand side, navigate to the three bars, hover over ",(0,r.jsx)(n.strong,{children:"Compute Engine"}),", and select ",(0,r.jsx)(n.strong,{children:"VM Instances"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-server-settings",children:"\ud83d\udfe0 Server Settings"}),"\n",(0,r.jsxs)(n.p,{children:["Now, navigate to ",(0,r.jsx)(n.strong,{children:'"Create Instance"'}),". Select ",(0,r.jsx)(n.strong,{children:'"CREATE VM FROM..."'})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Select ",(0,r.jsx)(n.strong,{children:'"Marketplace"'})," and search for ",(0,r.jsx)(n.strong,{children:'"Ubuntu 22.04 LTS (Jammy)"'}),"."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["It is ",(0,r.jsx)(n.strong,{children:"IMPORTANT"})," that you select this version and not the ",(0,r.jsx)(n.strong,{children:"Pro"})," version."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Launch the virtual operating system."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Now rename the server to ",(0,r.jsx)(n.strong,{children:'"(yourname)-h2h-server"'}),"."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["There is no requirement to what you name your server however it is easy to keep track of:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"who: started the server."}),"\n",(0,r.jsx)(n.li,{children:"what: the server will host."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Once that is done, ensure that your server is selected to run with ",(0,r.jsx)(n.strong,{children:'"E2"'})," under the ",(0,r.jsx)(n.strong,{children:'"Machine Configuration"'})," section."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Important"})," - under ",(0,r.jsx)(n.strong,{children:"Machine type"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["select ",(0,r.jsx)(n.strong,{children:"High CPU"})]}),"\n",(0,r.jsxs)(n.li,{children:["then select ",(0,r.jsx)(n.strong,{children:"e2-highcpu-8"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:'NOTE: If you did this right, the monthly estimate should be "$145.45"'}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Next, under ",(0,r.jsx)(n.strong,{children:"Identity and API access - Access scopes"})," select ",(0,r.jsx)(n.strong,{children:"Allow full access to all Cloud APIs"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Next, under ",(0,r.jsx)(n.strong,{children:"Firewall"}),", select both ",(0,r.jsx)(n.strong,{children:"Allow HTTP traffic"})," AND ",(0,r.jsx)(n.strong,{children:"Allow HTTPS traffic"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"ALL DONE HERE!"}),' Now select "CREATE".']}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Wait for the server to be created and then move on to the next steps."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-firewall-settings",children:"\ud83d\udfe0 Firewall Settings"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["At the top of the page, search for and click ",(0,r.jsx)(n.strong,{children:'"Firewall"'}),". Create a new firewall rule.","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:['Name it "(yourname)-http-allowall".',"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:'Enter "Allow all incoming connections to (yourname)\'s machines." in the description.'}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"Turn on logs."}),"\n",(0,r.jsxs)(n.li,{children:['Enter "(yourname)-http-server" in ',(0,r.jsx)(n.strong,{children:"Target tags"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:['Enter "0.0.0.0/0" in ',(0,r.jsx)(n.strong,{children:"Source IPV4 Ranges"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Under ",(0,r.jsx)(n.strong,{children:"Protocols and ports"}),", under ",(0,r.jsx)(n.strong,{children:"Specified protocols and ports"}),", under ",(0,r.jsx)(n.strong,{children:"BOTH TCP and UDP"}),' enter "80, 443, 8000".']}),"\n",(0,r.jsx)(n.li,{children:"Create!"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Navigate back to your vm machine, select it and click edit.","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:['Under both "Labels" and "Network Tags", enter ',(0,r.jsx)(n.strong,{children:'"(yourname)-http-server"'}),", and click save."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-ssh-and-terminal-instructions",children:"\ud83d\udfe0 SSH and Terminal Instructions"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Now we have to enter the SSH terminal and install the necessary packages."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"For this to work ensure that any settings on your device, allow pop-ups (including disabling any ad-blockers)."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:'There should be a button labeled "SSH" at your VM Machine, select that and you should have a terminal pop up on your screen.'}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Once that is loaded, now we have to install our libraries/packages for this to work. For that to happen we need to initialize an environment."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["We will be using Miniconda. Copy and paste ",(0,r.jsx)(n.code,{children:"wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh"})," into your terminal and press enter."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Enter the command ",(0,r.jsx)(n.code,{children:"bash Miniconda3-latest-Linux-x86_64.sh"})," and hit enter."]}),"\n",(0,r.jsx)(n.li,{children:"Now your terminal should be going through Miniconda's terms and conditions (to shortcut this press q)."}),"\n",(0,r.jsx)(n.li,{children:'Follow all instructions and select "yes" when prompted to.'}),"\n",(0,r.jsxs)(n.li,{children:["If the terminal asks for a folder location, you may hit ",(0,r.jsx)(n.strong,{children:"Enter"})," or select a folder yourself."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Once Miniconda is downloaded, enter ",(0,r.jsx)(n.code,{children:"source ~/.bashrc"}),"."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:'You should see a "(base)" environment to the left of your terminal line, if this appears you have taken all of the correct steps!'}),"\n",(0,r.jsxs)(n.li,{children:["We now have to create and activate our environment, copy and paste these commands into your terminal:","\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'conda create --name empirica_env python=3.9\nconda activate empirica_env\ncurl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.1/install.sh | bash\n\\. "$HOME/.nvm/nvm.sh"\nnvm install 22\nconda install jupyterlab\n'})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"You may give your environment another name as well."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Once those packages are installed, now install Caddy & Empirica:","\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"sudo apt install -y debian-keyring debian-archive-keyring apt-transport-https curl\ncurl -1sLf 'https://dl.cloudsmith.io/public/caddy/stable/gpg.key' | sudo gpg --dearmor -o /usr/share/keyrings/caddy-stable-archive-keyring.gpg\ncurl -1sLf 'https://dl.cloudsmith.io/public/caddy/stable/debian.deb.txt' | sudo tee /etc/apt/sources.list.d/caddy-stable.list\nsudo apt update\nsudo apt install caddy\ncurl -fsS https://install.empirica.dev | sh\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Now you should have a Caddyfile, we will edit it in vim:",(0,r.jsx)(n.code,{children:"sudo vi /etc/caddy/Caddyfile"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"IMPORTANT COMMANDS FOR VIM:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:'"i" to insert/edit text'}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:'"Esc" to stop inserting/editing'}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:'":" to enter "quit" mode'}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:'"q!" to quit without saving changes'}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:'"wq!" to quit and save changes'}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"In your Caddyfile, comment all code there out, and at the very top of the file insert:"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:":80 { \n  reverse_proxy :3000 \n}\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Quit and save changes!"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["[!NOTE]",(0,r.jsx)(n.br,{}),"\n","In the caddyfile, it's better to ",(0,r.jsx)(n.strong,{children:"only"})," keep the config changes mentioned above, and ",(0,r.jsx)(n.strong,{children:"remove all comments"})," in vim, then save & exit."]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-ssh-keygen--repo-instructions",children:"\ud83d\udfe0 SSH-Keygen & Repo Instructions"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Run ",(0,r.jsx)(n.code,{children:"ssh-keygen"}),".","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"You can pick and choose your own ssh-key password & location to store your ssh-key information."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Run ",(0,r.jsx)(n.code,{children:"cat ~/.ssh/id_rsa.pub"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"NOTE:"})," do not EVER print your private ssh-key!!!"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Copy your public key and go to your Github account.","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Go to your Github profile, and go to settings."}),"\n",(0,r.jsx)(n.li,{children:'Navigate to SSH and GPG keys, click "New SSH Key".'}),"\n",(0,r.jsx)(n.li,{children:'Name your key "gcp instance empirica game"'}),"\n",(0,r.jsxs)(n.li,{children:["Double-check that your key is an ",(0,r.jsx)(n.strong,{children:"authentication key"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Now, go to the H2H repo, and ",(0,r.jsx)(n.strong,{children:"clone using SSH"}),". Copy and paste that into your terminal!"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://github.com/user-attachments/assets/c3ce53e8-e96c-4fbb-97d2-1543702aea55",alt:"image"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Make sure ",(0,r.jsx)(n.code,{children:"git clone"})," is in front of your pasted link before you hit enter, i.e. for example \u2192  ",(0,r.jsx)(n.code,{children:"git clone git@github.com:Digital-Information-Research-Lab/empirica-dev.git"})]}),"\n"]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["[!WARNING]",(0,r.jsx)(n.br,{}),"\n","Don't forget to change the branch if required."]}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Now cd into your repository and enter ",(0,r.jsx)(n.code,{children:"cd client && npm i && cd ../server/ && npm i && cd ../ && empirica"}),".","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Once your build is created, hit ",(0,r.jsx)(n.code,{children:"Ctrl"})," + ",(0,r.jsx)(n.code,{children:"C"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Enter ",(0,r.jsx)(n.code,{children:"empirica bundle"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:['Move the newly created "tar.zst" file back into your home directory (use ',(0,r.jsx)(n.code,{children:"mv"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:["Now do ",(0,r.jsx)(n.code,{children:"empirica serve < tar.zst filename >"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Your server will be running!","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["To remove the tajriba.json local file and retry your build, run ",(0,r.jsx)(n.code,{children:"rm .empirica/local/*"})," first."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h1,{id:"-running-the-server-in-a-browser",children:"\ud83d\udfe2 Running the server in a browser"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Once your server is running, return to your GCP instance."}),"\n",(0,r.jsx)(n.li,{children:"Click on its external IP, this should take you to a new tab."}),"\n",(0,r.jsxs)(n.li,{children:["In the URL bar, ensure that your URL begins with ",(0,r.jsx)(n.strong,{children:"http://"})," and ends in either ",(0,r.jsx)(n.strong,{children:":80"})," or ",(0,r.jsx)(n.strong,{children:":80/admin"}),".","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["The admin username is ",(0,r.jsx)(n.strong,{children:'"admin"'}),"."]}),"\n",(0,r.jsx)(n.li,{children:"To access the admin password, contact the research team."}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"Now, you should be able to run experiments on your IP's admin page, players can join by entering your machine's external IP into a browser."}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.p,{children:"Happy Experimenting! \ud83e\udd17"}),"\n",(0,r.jsx)(n.hr,{})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>o});var i=s(6540);const r={},t=i.createContext(r);function l(e){const n=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);